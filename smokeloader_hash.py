from dword import DWORD as dword
from hash_lookup import get_dll_hashes

def smokeloader_hash(s):
    res = dword(0x1505)
    for b in s + b'\x00':
        temp = res
        res <<= 5
        res += temp
        res += b
    return res.val

l = lookup_table = get_dll_hashes(smokeloader_hash)
