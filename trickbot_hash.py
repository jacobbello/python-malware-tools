from dword import DWORD as dword
from hash_lookup import get_dll_hashes

x = 0xca895f6e
y = 0x3576a091

def compute_hash(data):
	res = dword(0)
	for b in data:
		res = ((res + b) * 0x401)
		_temp = res
		res = (res >> 6) ^ _temp
	res *= 9
	_temp = res
	res >>= 0xb
	res ^= _temp
	res *= 0x8001
	return (res & x) | ((~res) & y)

lookup_table = get_dll_hashes(compute_hash)
