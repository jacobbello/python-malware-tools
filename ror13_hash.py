from dword import DWORD as dword
from hash_lookup import get_dll_hashes

def smokeloader_hash(s, n=0):
    #s = bytes(str(s, 'utf8').upper(), 'utf8')
    res = dword(0)
    for b in s:
        _res = (res >> 0xd | res << 0x13) + b
        res = _res - 0x20
        if b < ord('a'):
            res = _res
    return (res + n).val

lookup_table = get_dll_hashes(smokeloader_hash)
